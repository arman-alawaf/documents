<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Laravel Documents</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
  </head>
  <body>

    <section>
      <div class="container-fluid py-3">
        <div class="row">
          <div class="col-12">

            <textarea rows="22" cols="100" class="form-control">
command
-------
composer require maatwebsite/excel
php artisan make:export KamsExport --model=Kam
php artisan make:import KamsImport --model=Kam


app/Exports/KamsExport.php
--------------------------
namespace App\Exports;

use App\Models\Kam;
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;

class KamsExport implements FromCollection, WithHeadings
{
    public function collection()
    {
        return Kam::select('id', 'name', 'email', 'phone', 'address', 'status', 'created_at', 'updated_at')->get();
    }
    public function headings(): array
    {
        return [
            'ID',
            'Name',
            'Email',
            'Phone',
            'Address',
            'Status',
            'Created At',
            'Updated At'
        ];
    }
}

app/Exports/KamsImport.php
--------------------------
namespace App\Imports;

use App\Models\Kam;
use Maatwebsite\Excel\Concerns\ToModel;
use Maatwebsite\Excel\Concerns\WithHeadingRow;

class KamsImport implements ToModel, WithHeadingRow
{
    public function model(array $row)
    {
        return new Kam([
            'id'      => $row['id'],
            'name'    => $row['name'],
            'email'   => $row['email'],
            'phone'   => $row['phone'],
            'address' => $row['address'],
            'status'  => $row['status'],
        ]);
    }
}

web.php
-------
use App\Exports\KamsExport;
use App\Imports\KamsImport;
use Maatwebsite\Excel\Facades\Excel;

Route::get('/kams-export', function () {
    return Excel::download(new KamsExport, 'kams.xlsx'); // can use .csv
});

Route::post('/kams-import', function (Illuminate\Http\Request $request) {
    Excel::import(new KamsImport, $request->file('file'));
    return back()->with('success', 'File Imported Successfully');
});

blade
-----
<div class="mt-3">
    <a href="{{ url('kams-export') }}" class="btn btn-success">Export File</a>

    <form action="{{ url('kams-import') }}" method="POST" enctype="multipart/form-data" class="d-inline">
        @csrf
        <input type="file" name="file" required>
        <button type="submit" class="btn btn-primary">Import File</button>
    </form>
</div>

Kam.php
-------
    protected $fillable = [
        'name',
        'email',
        'phone',
        'address',
        'status'
    ];










            </textarea>

          </div>
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  </body>
</html>